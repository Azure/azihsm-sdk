diff --git a/onecore/ds/published/inc/ncrypt.w b/onecore/ds/published/inc/ncrypt.w
index 41ccd5ba89c443..cf353d98f46f76 100644
--- a/onecore/ds/published/inc/ncrypt.w
+++ b/onecore/ds/published/inc/ncrypt.w
@@ -85,6 +85,8 @@ typedef struct NCRYPT_ALLOC_PARA {
 #define MS_NGC_KEY_STORAGE_PROVIDER         L"Microsoft Passport Key Storage Provider"
 #define MS_PLUTON_CRYPTO_PROVIDER           L"Microsoft Pluton Cryptographic Provider"
 
+#define AZIHSM_KEY_STORAGE_PROVIDER         L"Microsoft Azure Integrated HSM Key Storage Provider"
+
 //
 // Key name for sealing
 //
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/altstorage.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/altstorage.cpp
index 41efc4b0c2e6a1..bd7f630e6d5247 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/altstorage.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/altstorage.cpp
@@ -25,13 +25,13 @@ OpenKey(
     }
 
     *phKey = NULL;
-
-    status = NCryptOpenStorageProvider(
-        &hProv,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (status != ERROR_SUCCESS)
-    {
+
+    status = NCryptOpenStorageProvider(
+        &hProv,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"*** Error 0x%lx returned by open storage provider. ", status);
         goto cleanup;
     }
@@ -136,13 +136,13 @@ CreateOverwriteableRSA2048TestKey(
     DWORD   dwFlags = NCRYPT_NO_CACHED_PASSWORD | NCRYPT_OVERWRITE_KEY_FLAG;
 
     dwFlags |= g_fUseVirtualIsolation ? NCRYPT_USE_VIRTUAL_ISOLATION_FLAG : 0;
-
-    status = NCryptOpenStorageProvider(
-        &hProv,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (status != ERROR_SUCCESS)
-    {
+
+    status = NCryptOpenStorageProvider(
+        &hProv,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"*** Error 0x%lx fail to open storage provider. ", status);
         goto cleanup;
     }
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/cases.c b/onecore/ds/security/cryptoapi/ncrypt/test/storage/cases.c
index 9e21ec05feeb67..db33a8fb2bc283 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/cases.c
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/cases.c
@@ -3131,13 +3131,13 @@ TestAccessControlProperty(__in LPWSTR pszAlgId)
     //
     // Create a CNG machine key.
     //
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -3357,13 +3357,13 @@ TestLastModifiedProperty(__in LPWSTR pszAlgId)
     NTSTATUS Status;
 
     printf("---- Test LAST_MODIFIED property ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -3480,13 +3480,13 @@ TestNameProperty(__in LPWSTR pszAlgId)
     NTSTATUS Status;
 
     printf("---- Test NAME property ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -3669,13 +3669,13 @@ TestUniqueNameProperty(
     //
 
     printf("---- Test UNIQUE_NAME property ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -3885,13 +3885,13 @@ TestMultipleKeys(
     //
 
     printf("---- Test AT_KEYEXCHANGE and AT_SIGNATURE keys ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -4523,13 +4523,13 @@ TestKeyOverwrite(
     //
 
     printf("---- Test Key Overwrite ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -4812,13 +4812,13 @@ TestPKCS7PrivateKeyBlob(
 
     // Get handle to appropriate key storage provider.
     printf("---- Test PKCS7 Private Key Blob ----\n");
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(Status != ERROR_SUCCESS)
+    {
         printf("**** Error 0x%x returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -5567,13 +5567,13 @@ TestChainingModeProperty()
     for( i=0; i<ARRAYSIZE(rgChainingModeTestStruct); i++)
     {
         for( j=0; j<ARRAYSIZE(rgwszChainingModes); j++)
-        {
-            Status = NCryptOpenStorageProvider(
-                                &hProvider,
-                                MS_KEY_STORAGE_PROVIDER,
-                                0);
-            if(Status != ERROR_SUCCESS)
-            {
+        {
+            Status = NCryptOpenStorageProvider(
+                                &hProvider,
+                                AZIHSM_KEY_STORAGE_PROVIDER,
+                                0);
+            if(Status != ERROR_SUCCESS)
+            {
                 printf("**** Error 0x%x returned by NCryptOpenStorageProvider in %ls, %ls \n", Status, rgChainingModeTestStruct[i].wszAlgName, rgwszChainingModes[j] );
                 goto cleanup;
             }
@@ -6132,13 +6132,13 @@ DWORD   dwUiFlags
     DWORD   dwExportPolicy = NCRYPT_ALLOW_EXPORT_FLAG | NCRYPT_ALLOW_PLAINTEXT_EXPORT_FLAG;
 
     printf("=== start create cng test key password %ls === \n", pwszPassword);
-
-    status = NCryptOpenStorageProvider(
-        &hProv,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (status != ERROR_SUCCESS)
-    {
+
+    status = NCryptOpenStorageProvider(
+        &hProv,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (status != ERROR_SUCCESS)
+    {
         printf("*** Error 0x%x fail to open storage provider. \n", status);
         goto cleanup;
     }
@@ -6340,13 +6340,13 @@ _Out_ NCRYPT_KEY_HANDLE* phKey
     NTSTATUS status = ERROR_SUCCESS;
     NCRYPT_PROV_HANDLE hProv = 0;
     NCRYPT_KEY_HANDLE hKey = 0;
-
-    status = NCryptOpenStorageProvider(
-        &hProv,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (status != ERROR_SUCCESS)
-    {
+
+    status = NCryptOpenStorageProvider(
+        &hProv,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (status != ERROR_SUCCESS)
+    {
         printf("*** Error 0x%x returned by open storage provider. \n", status);
         goto cleanup;
     }
@@ -6482,13 +6482,13 @@ DWORD dwUiFlags)
         printf("*** Error 0x%x returned by export key. \n", status);
         goto cleanup;
     }
-
-    status = NCryptOpenStorageProvider(
-        &hProv,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (status != ERROR_SUCCESS)
-    {
+
+    status = NCryptOpenStorageProvider(
+        &hProv,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (status != ERROR_SUCCESS)
+    {
         printf("*** Error 0x%x returned by open storage provider. \n", status);
         goto cleanup;
     }
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/common.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/common.cpp
index 2137d9c3749fa7..e5ede76e056d11 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/common.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/common.cpp
@@ -1703,13 +1703,13 @@ CreateTestCertStore(
         printf("**** Error 0x%lx returned from CertCreateCertificateContext\n", Status);
         goto cleanup;
     }
-
-    Status = NCryptOpenStorageProvider(
-                        &hProvider,
-                        MS_KEY_STORAGE_PROVIDER,
-                        0);
-    if(!NT_SUCCESS(Status))
-    {
+
+    Status = NCryptOpenStorageProvider(
+                        &hProvider,
+                        AZIHSM_KEY_STORAGE_PROVIDER,
+                        0);
+    if(!NT_SUCCESS(Status))
+    {
         printf("**** Error 0x%lx returned by NCryptOpenStorageProvider\n", Status);
         goto cleanup;
     }
@@ -1746,13 +1746,13 @@ CreateTestCertStore(
         goto cleanup;
     }
 
-    ZeroMemory(&KeyProvInfo, sizeof(KeyProvInfo));
-
-    KeyProvInfo.pwszContainerName = L"PKCS7 Blob Test Key";
-    KeyProvInfo.pwszProvName = MS_KEY_STORAGE_PROVIDER;
-
-    if(!CertSetCertificateContextProperty(
-                        pCertContext,
+    ZeroMemory(&KeyProvInfo, sizeof(KeyProvInfo));
+
+    KeyProvInfo.pwszContainerName = L"PKCS7 Blob Test Key";
+    KeyProvInfo.pwszProvName = AZIHSM_KEY_STORAGE_PROVIDER;
+
+    if(!CertSetCertificateContextProperty(
+                        pCertContext,
                         CERT_KEY_PROV_INFO_PROP_ID,
                         0,
                         &KeyProvInfo))
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/export.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/export.cpp
index 12dcd5729227e3..404acb87d48603 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/export.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/export.cpp
@@ -821,13 +821,13 @@ _testVirtualIsoAllowArchiveExportPolicy()
     NCRYPT_KEY_HANDLE hKey = NULL;
     DWORD dwArchivePolicyFlag = NCRYPT_ALLOW_ARCHIVING_FLAG;
     SECURITY_STATUS Status = ERROR_SUCCESS;
-
-    Status = NCryptOpenStorageProvider(
-                &hProvider,
-                MS_KEY_STORAGE_PROVIDER,
-                0);
-    if (Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                &hProvider,
+                AZIHSM_KEY_STORAGE_PROVIDER,
+                0);
+    if (Status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"****_testVirtualIsoAllowArchiveExportPolicy: Error 0x%lx returned by NCryptOpenStorageProvider", Status);
         goto cleanup;
     }
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/import.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/import.cpp
index 35c921fcc24f0b..c985ab8457dc1b 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/import.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/import.cpp
@@ -746,13 +746,13 @@ DoVsmKeyImportTest()
     */
     if (g_hProvider)
     {
-        // free provider if already exist before Open 
-        NCryptFreeObject(g_hProvider);
-    }
-    if (FAILED(hr = NCryptOpenStorageProvider(&g_hProvider, MS_KEY_STORAGE_PROVIDER, 0)))
-    {
-        LOG_OUTPUT(L"Error opening provider.");
-        goto Cleanup;
+        // free provider if already exist before Open
+        NCryptFreeObject(g_hProvider);
+    }
+    if (FAILED(hr = NCryptOpenStorageProvider(&g_hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0)))
+    {
+        LOG_OUTPUT(L"Error opening provider.");
+        goto Cleanup;
     }
 
     // Create an import-only isolated key
@@ -1479,13 +1479,13 @@ CreateExportableKey(
     dwFlags |= NCRYPT_OVERWRITE_KEY_FLAG;
 
     DWORD dwExportFlags = NCRYPT_ALLOW_EXPORT_FLAG;
-
-    Status = NCryptOpenStorageProvider(
-                &hProvider,
-                MS_KEY_STORAGE_PROVIDER,
-                0);
-    if (Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                &hProvider,
+                AZIHSM_KEY_STORAGE_PROVIDER,
+                0);
+    if (Status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"****CreateExportableKey: NCryptOpenStorageProvider failed with 0x%08x.", Status);
         goto cleanup;
     }
@@ -1666,13 +1666,13 @@ ImportProtectedKey(
 
         dwFlags |= NCRYPT_OVERWRITE_KEY_FLAG;
     }
-
-    Status = NCryptOpenStorageProvider(
-                &hProvider,
-                MS_KEY_STORAGE_PROVIDER,
-                0);
-    if (Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                &hProvider,
+                AZIHSM_KEY_STORAGE_PROVIDER,
+                0);
+    if (Status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"****ImportProtectedKey: NCryptOpenStorageProvider failed with 0x%08x.", Status);
         goto cleanup;
     }
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/kdf.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/kdf.cpp
index 32f635130e6f37..e0c2db568feed5 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/kdf.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/kdf.cpp
@@ -438,13 +438,13 @@ TestImportAndExport(
     //
     //  NCryptOpenStorageProvider
     //
-
-    Status = NCryptOpenStorageProvider(
-                                        &hProv,
-                                        MS_KEY_STORAGE_PROVIDER,
-                                        0);
-
-    if( ERROR_SUCCESS != Status )
+
+    Status = NCryptOpenStorageProvider(
+                                        &hProv,
+                                        AZIHSM_KEY_STORAGE_PROVIDER,
+                                        0);
+
+    if( ERROR_SUCCESS != Status )
     {
         TRACE_ERROR_STATUS(Status);
         goto cleanup;
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/ksptests.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/ksptests.cpp
index 47c8eb8bb775de..c6902148660ffe 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/ksptests.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/ksptests.cpp
@@ -43,13 +43,13 @@ namespace KSPTestNS
     {
         // use Key Guard
         g_fUseVirtualIsolation = TRUE;
-        // use CNG
-        g_fCngMode = TRUE;
-        // always use MS_KSP
-        g_pszProvName = MS_KEY_STORAGE_PROVIDER;
-    }
-
-    void KSPTestCleanup()
+        // use CNG
+        g_fCngMode = TRUE;
+        // always use MS_KSP
+        g_pszProvName = AZIHSM_KEY_STORAGE_PROVIDER;
+    }
+
+    void KSPTestCleanup()
     {
         if (g_pszProvName && g_fAllocProv)
         {
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/NCryptDeriveKey.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/NCryptDeriveKey.cpp
index 559182e71342d2..afed6788dedd5b 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/NCryptDeriveKey.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/NCryptDeriveKey.cpp
@@ -1142,13 +1142,13 @@ Return Value:
 
         // A exports DH/ECDH public key
         
-        if (!NT_SUCCESS(status = NCryptExportKey(
-            hKeyA,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            NULL,
-            0,
+        if (!NT_SUCCESS(status = NCryptExportKey(
+            hKeyA,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            NULL,
+            0,
             &cbPubBlobA,
             0)))
         {
@@ -1164,13 +1164,13 @@ Return Value:
             goto Cleanup;
         }
        
-        if (!NT_SUCCESS(status = NCryptExportKey(
-            hKeyA,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            pbPubBlobA,
-            cbPubBlobA,
+        if (!NT_SUCCESS(status = NCryptExportKey(
+            hKeyA,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            pbPubBlobA,
+            cbPubBlobA,
             &cbPubBlobA,
             0)))
         {
@@ -1180,13 +1180,13 @@ Return Value:
 
         // B exports DH/ECDH public key
         
-        if (!NT_SUCCESS(status = NCryptExportKey(
-            hKeyB,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            NULL,
-            0,
+        if (!NT_SUCCESS(status = NCryptExportKey(
+            hKeyB,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            NULL,
+            0,
             &cbPubBlobB,
             0)))
         {
@@ -1202,13 +1202,13 @@ Return Value:
             goto Cleanup;
         }
         
-        if (!NT_SUCCESS(status = NCryptExportKey(
-            hKeyB,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            pbPubBlobB,
-            cbPubBlobB,
+        if (!NT_SUCCESS(status = NCryptExportKey(
+            hKeyB,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            pbPubBlobB,
+            cbPubBlobB,
             &cbPubBlobB,
             0)))
         {
@@ -1219,13 +1219,13 @@ Return Value:
 
         //A imports B's public key
         
-        if (!NT_SUCCESS(status = NCryptImportKey(
-            pDeriveKeyInfo->hProvider,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            &hPubKeyA,
-            pbPubBlobB,
+        if (!NT_SUCCESS(status = NCryptImportKey(
+            pDeriveKeyInfo->hProvider,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            &hPubKeyA,
+            pbPubBlobB,
             cbPubBlobB,
             0)))
         {
@@ -1236,13 +1236,13 @@ Return Value:
 
         //B imports A's public key
         
-        if (!NT_SUCCESS(status = NCryptImportKey(
-            pDeriveKeyInfo->hProvider,
-            NULL,
-            BCRYPT_PUBLIC_KEY_BLOB,
-            NULL,
-            &hPubKeyB,
-            pbPubBlobA,
+        if (!NT_SUCCESS(status = NCryptImportKey(
+            pDeriveKeyInfo->hProvider,
+            NULL,
+            NCRYPT_OPAQUETRANSPORT_BLOB,
+            NULL,
+            &hPubKeyB,
+            pbPubBlobA,
             cbPubBlobA,
             0)))
         {
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/additionalScenarios.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/additionalScenarios.cpp
index dec175284a7e08..af2c973c1c8eed 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/additionalScenarios.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/additionalScenarios.cpp
@@ -56,13 +56,13 @@ void FailNCryptDeriveKey()
     VERIFY_ARE_EQUAL(NTE_INVALID_HANDLE, status);
 
     LOG_OUTPUT(L"Case 2 - Provide invalid params\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
         goto Cleanup;
     }
 
@@ -303,13 +303,13 @@ void FailNCryptNotifyChangeKey()
     VERIFY_ARE_EQUAL(NTE_INVALID_HANDLE, status);
 
     LOG_OUTPUT(L"Case 2 - Provide invalid event handle\n");
-
-    if (!NT_SUCCESS(NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
     }
 
     status = NCryptNotifyChangeKey(hProvider, &hEvent, NULL);
@@ -348,13 +348,13 @@ void AdditionalNCryptImportKey()
     DWORD dwPolicy = 0;
 
     LOG_OUTPUT(L"Start Test - NCryptImportKey on CAPI blobs\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
         goto Cleanup;
     }
 
@@ -549,13 +549,13 @@ void FailNCryptTranslateHandle()
     VERIFY_ARE_EQUAL(NTE_INVALID_PARAMETER, status);
 
     
-    LOG_OUTPUT(L"Case 2 - NCryptTranslateHandle with dwFlags\n");
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
+    LOG_OUTPUT(L"Case 2 - NCryptTranslateHandle with dwFlags\n");
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", status);
         goto Cleanup;
     }
 
@@ -642,13 +642,13 @@ void AdditionalGetSetProperty()
     WCHAR                   rgwchDescString[LOG_BUFFER_LEN] = { 0 };
 
     logWrapper(L"Start Test - AdditionalGetSetProperty\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        StringCbPrintf(rgwchDescString, LOG_BUFFER_LEN * sizeof(WCHAR), L"NCryptOpenStorageProvider failed with 0x%x\n", status);
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        StringCbPrintf(rgwchDescString, LOG_BUFFER_LEN * sizeof(WCHAR), L"NCryptOpenStorageProvider failed with 0x%x\n", status);
         logWrapper(rgwchDescString);
         goto Cleanup;
     }
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptCreatePersistedKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptCreatePersistedKey.inf
index c4b1e16b9c955e..6346d56d890a2a 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptCreatePersistedKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptCreatePersistedKey.inf
@@ -59,13 +59,13 @@ NUMBEROFCASES  = 54
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 0
@@ -75,45 +75,45 @@ FLAGS           = 0
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+FLAGS           = 2
 
 ;
 ; bad flags with keyspec 1
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 1
-FLAGS           = 2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 1
+FLAGS           = 2
 
 ;
 ; bad flags for ECDSA_256
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
@@ -125,91 +125,91 @@ FLAGS           = 2
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
@@ -217,51 +217,51 @@ FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 2
 FLAGS           = 2
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 1
 FLAGS           = 2
@@ -272,134 +272,107 @@ FLAGS           = 2
 
 ;
 ; NCRYPT_MACHINE_KEY_FLAG
-;
-
-
-VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 20
-
-
-VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 1
-FLAGS           = 20
-
-
-
-VARID           = 1.18
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+;
+
+
+VARID           = 1.18
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
@@ -407,51 +380,51 @@ FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
 
 
 VARID           = 1.29
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 20
@@ -465,77 +438,77 @@ FLAGS           = 20
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.35
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = CngKspApitestKey
 KEYSPEC         = 0
 FLAGS           = 0
@@ -550,13 +523,13 @@ VARID           = 1.1
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = NTE_INVALID_HANDLE
 POSITIVECASE    = FALSE
-PROVNAME        = INVALID-LONG
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 1
-FLAGS           = 0
+PROVNAME        = INVALID-LONG
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 1
+FLAGS           = 0
 
 
 ;
@@ -564,106 +537,94 @@ FLAGS           = 0
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = INVALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = INVALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+FLAGS           = 0
 
 ;
 ; NULL key name
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = NULL
-KEYSPEC         = 2
-FLAGS           = 0
-
-VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.44
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
@@ -678,13 +639,13 @@ VARID           = 2.1
 TESTNAME        = NULL handle
 EXPECTEDVALUE   = NTE_INVALID_HANDLE
 POSITIVECASE    = FALSE
-PROVNAME        = INVALID-SHORT
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 0
+PROVNAME        = INVALID-SHORT
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+FLAGS           = 0
 
 ;invalid handle value (alg does not matter)
 
@@ -692,26 +653,26 @@ VARID           = 2.2
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
 POSITIVECASE    = FALSE
-PROVNAME        = INVALID-SHORT
-PROVFLAGS       = 1
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 0
+PROVNAME        = INVALID-SHORT
+PROVFLAGS       = 1
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+FLAGS           = 0
 
 ; invalid flags
 VARID           = 2.3
-TESTNAME        = INVALID flags
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-FLAGS           = 3
+TESTNAME        = INVALID flags
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+FLAGS           = 3
 
 ;--------------------------------- 47
 
@@ -721,90 +682,78 @@ FLAGS           = 3
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
-KEYSPEC         = 2
-FLAGS           = 0
-
-VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P256
 KEYNAME         = INVALID-LONG
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P384
 KEYNAME         = INVALID-LONG
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDH_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDH_P521
 KEYNAME         = INVALID-LONG
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P256
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P256
 KEYNAME         = INVALID-LONG
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P384
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P384
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
 
 
 VARID           = 1.54
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-KEYHANDLEVALID  = VALID
-ALGID           = ECDSA_P521
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+KEYHANDLEVALID  = VALID
+ALGID           = ECDSA_P521
 KEYNAME         = NULL
 KEYSPEC         = 0
 FLAGS           = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDecrypt.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDecrypt.inf
index 0f5d1a0be4cf19..b71bfec94f7a36 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDecrypt.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDecrypt.inf
@@ -58,29 +58,29 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 2048
-KEYSPEC         = 2
-KEYFLAGS        = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 2048
+KEYSPEC         = 2
+KEYFLAGS        = 1
 ENCFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 256
 INPLACE         = FALSE
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_HANDLE
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 2048
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -95,16 +95,16 @@ INPLACE         = FALSE
 ;
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 2048
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 2048
+KEYSPEC         = 2
+KEYFLAGS        = 0
 ENCFLAGS        = 1
 FLAGS           = 1
 INPUTLEN        = 256
@@ -112,16 +112,16 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 2048
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 2048
+KEYSPEC         = 2
+KEYFLAGS        = 0
 ENCFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 256
@@ -129,16 +129,16 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 ENCFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
@@ -146,32 +146,32 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 ENCFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
 INPLACE         = TRUE
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 ENCFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeleteKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeleteKey.inf
index 400f9c97b0dc4b..a6b650aa9bd2c3 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeleteKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeleteKey.inf
@@ -43,13 +43,13 @@ NUMBEROFCASES  = 11
 ; long key name
 ;
 VARID           = 1.1
-TESTNAME        = ECDH_P256
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDH_P256
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -57,26 +57,26 @@ FLAGS           = 0
 
 
 VARID           = 1.2
-TESTNAME        = ECDH_P384
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDH_P384
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
 FLAGS           = 0
 
 VARID           = 1.3
-TESTNAME        = ECDH_P521
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDH_P521
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -86,26 +86,26 @@ FLAGS           = 0
 ;
 
 VARID           = 1.4
-TESTNAME        = ECDSA_P256
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDSA_P256
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
 FLAGS           = 0
 
 VARID           = 1.5
-TESTNAME        = ECDSA_P384
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P384
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDSA_P384
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P384
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -113,13 +113,13 @@ FLAGS           = 0
 ; ------------------------------------- 5
 
 VARID           = 1.6
-TESTNAME        = ECDSA_P521
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P521
-KEYNAME         = CngKspApitestKey
+TESTNAME        = ECDSA_P521
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -129,13 +129,13 @@ FLAGS           = 0
 
 
 VARID           = 1.7
-TESTNAME        = RSA
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = RSA
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -161,13 +161,13 @@ KEYFLAGS        = 0
 FLAGS           = 0
 
 VARID           = 2.2
-TESTNAME        = NTE_BAD_FLAGS
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = CngKspApitestKey
+TESTNAME        = NTE_BAD_FLAGS
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeriveKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeriveKey.inf
index e9772ba473006c..fef349d0addf48 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeriveKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptDeriveKey.inf
@@ -40,118 +40,118 @@ NUMBEROFCASES	= 14
 
 
 VARID			= 1.1
-TESTNAME		= Derive DH HASH Key 
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
-KDFNAME			= HASH
-FLAGS			= 0
-SECRETPREPEND 	= FALSE
-SECRETAPPEND	= FALSE
+TESTNAME		= Derive DH HASH Key
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
+KDFNAME			= SP800_108_CTR_HMAC
+FLAGS			= 0
+SECRETPREPEND 	= FALSE
+SECRETAPPEND	= FALSE
 HMACKEY		= FALSE
 TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 1.2
-TESTNAME		= Derive DH HASH Key Prepend
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
-KDFNAME			= HASH
-FLAGS			= 0
-SECRETPREPEND 	= TRUE
-SECRETAPPEND	= FALSE
+TESTNAME		= Derive DH HASH Key Prepend
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
+KDFNAME			= SP800_108_CTR_HMAC
+FLAGS			= 0
+SECRETPREPEND 	= TRUE
+SECRETAPPEND	= FALSE
 HMACKEY		= FALSE
 TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 
 VARID			= 1.3
-TESTNAME		= Derive DH HASH Key Append
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
-KDFNAME			= HASH
-FLAGS			= 0
-SECRETPREPEND 	= FALSE
-SECRETAPPEND	= TRUE
+TESTNAME		= Derive DH HASH Key Append
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
+KDFNAME			= SP800_108_CTR_HMAC
+FLAGS			= 0
+SECRETPREPEND 	= FALSE
+SECRETAPPEND	= TRUE
 HMACKEY		= FALSE
 TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 1.4
-TESTNAME		= Derive DH HASH Key Prepend and Append
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
-KDFNAME			= HASH
-FLAGS			= 0
-SECRETPREPEND 	= TRUE
-SECRETAPPEND	= TRUE
+TESTNAME		= Derive DH HASH Key Prepend and Append
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
+KDFNAME			= SP800_108_CTR_HMAC
+FLAGS			= 0
+SECRETPREPEND 	= TRUE
+SECRETAPPEND	= TRUE
 HMACKEY		= FALSE
 TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 2.1
-TESTNAME		= Derive DH HMAC 
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 0
 SECRETPREPEND 	= FALSE
@@ -161,22 +161,22 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-VARID			= 2.2
-TESTNAME		= Derive DH HMAC Prepend
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+VARID			= 2.2
+TESTNAME		= Derive DH HMAC Prepend
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 0
 SECRETPREPEND 	= TRUE
@@ -186,23 +186,23 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 2.3
-TESTNAME		= Derive DH HMAC Append
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC Append
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 0
 SECRETPREPEND 	= FALSE
@@ -212,23 +212,23 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 2.4
-TESTNAME		= Derive DH HMAC Prepend and Append
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC Prepend and Append
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 0
 SECRETPREPEND 	= TRUE
@@ -238,24 +238,24 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 
 VARID			= 2.5
-TESTNAME		= Derive DH HMAC KDF_USE_SECRET_AS_HMAC_KEY_FLAG
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC KDF_USE_SECRET_AS_HMAC_KEY_FLAG
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 1
 SECRETPREPEND 	= FALSE
@@ -265,23 +265,23 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 2.6
-TESTNAME		= Derive DH HMAC Prepend KDF_USE_SECRET_AS_HMAC_KEY_FLAG
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC Prepend KDF_USE_SECRET_AS_HMAC_KEY_FLAG
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 1
 SECRETPREPEND 	= TRUE
@@ -291,23 +291,23 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 2.7
-TESTNAME		= Derive DH HMAC Append KDF_USE_SECRET_AS_HMAC_KEY_FLAG
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH HMAC Append KDF_USE_SECRET_AS_HMAC_KEY_FLAG
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 1
 SECRETPREPEND 	= FALSE
@@ -317,22 +317,22 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-VARID			= 2.8
-TESTNAME		= Derive DH HMAC Prepend and Append KDF_USE_SECRET_AS_HMAC_KEY_FLAG
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+VARID			= 2.8
+TESTNAME		= Derive DH HMAC Prepend and Append KDF_USE_SECRET_AS_HMAC_KEY_FLAG
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= HMAC
 FLAGS			= 1
 SECRETPREPEND 	= TRUE
@@ -342,22 +342,22 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-VARID			= 3.1
-TESTNAME		= Derive DH TLS_PRF
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+VARID			= 3.1
+TESTNAME		= Derive DH TLS_PRF
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= TLS_PRF
 FLAGS			= 0
 SECRETPREPEND 	= FALSE
@@ -367,23 +367,23 @@ TLSLABEL		= TRUE
 TLSSEED			= TRUE
 PARTYUIINFO	 	= FALSE
 PARTYVIINFO		= FALSE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= FALSE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= FALSE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID			= 4.1
-TESTNAME		= Derive DH SP800_56A_CONCAT
-EXPECTEDVALUE	= ERROR_SUCCESS
-POSITIVECASE	= TRUE
-ALGID			= DH
-SECRETHANDLE	= VALID
-BLOBBUF			= VALID
-BLOBLEN			= VALID
+TESTNAME		= Derive DH SP800_56A_CONCAT
+EXPECTEDVALUE	= ERROR_SUCCESS
+POSITIVECASE	= TRUE
+ALGID			= ECDH_P256
+SECRETHANDLE	= VALID
+BLOBBUF			= VALID
+BLOBLEN			= VALID
 KDFNAME			= SP800_56A_CONCAT
 FLAGS			= 0
 SECRETPREPEND 	= FALSE
@@ -393,10 +393,10 @@ TLSLABEL		= FALSE
 TLSSEED			= FALSE
 PARTYUIINFO	 	= TRUE
 PARTYVIINFO		= TRUE
-SUPPPUBINFO		= FALSE
-SUPPPRIVINFO	= FALSE
-SP800ALGID		= TRUE
-KEYLEN		= 1024
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
+SUPPPUBINFO		= FALSE
+SUPPPRIVINFO	= FALSE
+SP800ALGID		= TRUE
+KEYLEN		= 256
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEncrypt.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEncrypt.inf
index 691f5269c521f0..fc6755b875087f 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEncrypt.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEncrypt.inf
@@ -38,16 +38,16 @@ NUMBEROFCASES  = 13
 ;=====================Negative TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 1
 INPUTLEN        = 128		; 1000 bits
 INPLACE         = FALSE
@@ -55,16 +55,16 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FLASE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 2048
-KEYSPEC         = 1
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FLASE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 2048
+KEYSPEC         = 1
+KEYFLAGS        = 0
 FLAGS           = 1
 INPUTLEN        = 256		; 1000 bits
 INPLACE         = FALSE
@@ -72,13 +72,13 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P384
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P384
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -88,13 +88,13 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P521
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -105,13 +105,13 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -122,13 +122,13 @@ INPLACE         = FALSE
 ;---------------------------------------------------- 5
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -138,13 +138,13 @@ INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -160,29 +160,29 @@ INPLACE         = FALSE
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_KEY_STATE
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_KEY_STATE
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 125
 INPLACE         = FALSE
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_HANDLE
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -191,16 +191,16 @@ INPUTLEN        = 126
 INPLACE         = TRUE
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 126
 INPLACE         = TRUE
@@ -208,16 +208,16 @@ INPLACE         = TRUE
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.15
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
 INPLACE         = TRUE
@@ -225,16 +225,16 @@ INPLACE         = TRUE
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.16
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
 INPLACE         = TRUE
@@ -242,16 +242,16 @@ INPLACE         = TRUE
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.17
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 INPUTLEN        = 128
 INPLACE         = FALSE
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumAlgorithms.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumAlgorithms.inf
index e091c7df157dd9..d76295a84f9a39 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumAlgorithms.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumAlgorithms.inf
@@ -37,13 +37,13 @@ NUMBEROFCASES  = 8
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = VALID
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = VALID
 COUNTVALID      = VALID
 FLAGS           = 0
 
@@ -78,13 +78,13 @@ FLAGS           = 123
 
 
 VARID           = 2.4
-TESTNAME        = Invalid flags
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = VALID
+TESTNAME        = Invalid flags
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = VALID
 COUNTVALID      = VALID
 FLAGS           = 123
 
@@ -92,13 +92,13 @@ FLAGS           = 123
 
 ; invalid count
 VARID           = 2.2
-TESTNAME        = INVALID count
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = VALID
+TESTNAME        = INVALID count
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = VALID
 COUNTVALID      = INVAlID
 FLAGS           = 0
 
@@ -106,38 +106,38 @@ FLAGS           = 0
 
 ; invalid list
 VARID           = 2.3
-TESTNAME        = INVALID list
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = INVALID
+TESTNAME        = INVALID list
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = INVALID
 COUNTVALID      = VALID
 FLAGS           = 123
 
 ; invalid list and count
 VARID           = 2.4
-TESTNAME        = INVALID list and count
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = INVALID
+TESTNAME        = INVALID list and count
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = INVALID
 COUNTVALID      = INVALID
 FLAGS           = 0
 
 
 ; invalid list, count, and flags
 VARID           = 2.5
-TESTNAME        = INVALID flags, list and count
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGOPS        = 0
-LISTVALID       = INVALID
+TESTNAME        = INVALID flags, list and count
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGOPS        = 0
+LISTVALID       = INVALID
 COUNTVALID      = INVALID
 FLAGS           = 3435
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumKeys.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumKeys.inf
index 115356fdcaa2b1..82ed6613f5b15e 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumKeys.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptEnumKeys.inf
@@ -41,13 +41,13 @@ NUMBEROFCASES  = 4
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-SCOPE           = NULL
-KEYVALID        = VALID
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+SCOPE           = NULL
+KEYVALID        = VALID
 STATEVALID      = VALID
 FLAGS           = 2
 
@@ -65,13 +65,13 @@ FLAGS           = 0
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-SCOPE           = NULL
-KEYVALID        = VALID
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+SCOPE           = NULL
+KEYVALID        = VALID
 STATEVALID      = VALID
 FLAGS           = 0
 
@@ -80,25 +80,25 @@ FLAGS           = 0
 ; invalid flags
 
 VARID           = 2.1
-TESTNAME        = Invalid flags
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-SCOPE           = NULL
-KEYVALID        = VALID
+TESTNAME        = Invalid flags
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+SCOPE           = NULL
+KEYVALID        = VALID
 STATEVALID      = VALID
 FLAGS           = 123
 
 
 ; --- with issues --
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-SCOPE           = TEST
-KEYVALID        = VALID
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+SCOPE           = TEST
+KEYVALID        = VALID
 STATEVALID      = VALID
 FLAGS           = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFinalizeKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFinalizeKey.inf
index a1388c88b9f3b0..9971aafee67adf 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFinalizeKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFinalizeKey.inf
@@ -36,15 +36,15 @@ Signature="$Windows NT$"
 NUMBEROFCASES  = 6
 
 ; NULL handle value (alg does not matter)
-
-VARID           = 2.1
-TESTNAME        = NULL handle
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P521
-KEYNAME         = INVALID-LONG
+
+VARID           = 2.1
+TESTNAME        = NULL handle
+EXPECTEDVALUE   = NTE_INVALID_HANDLEk
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+KEYNAME         = INVALID-LONG
 KEYSPEC         = 2
 KEYFLAGS        = 0
 FLAGS           = 0
@@ -54,60 +54,131 @@ FLAGS           = 0
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-KEYFLAGS        = 0
-FLAGS           = 0
-
-
-;=====================NEGATIVE TESTS====================
-
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.3
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.4
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.5
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P384
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.6
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+VARID           = 1.6
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = AES
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
+FLAGS           = 0
+
+;=====================NEGATIVE TESTS====================
+
 
 
 
 VARID           = 2.1
-TESTNAME        = NULL handle
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = NULL handle
+EXPECTEDVALUE   = NTE_INVALID_HANDLE
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = INVALID-LONG
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 
 ; ------------------------------------- 3
 
 VARID           = 2.1
-TESTNAME        = NULL handle
-EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 2
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = NULL handle
+EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 2
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 
 VARID           = 2.5
 TESTNAME        = NULL handle
 EXPECTEDVALUE   = NTE_INVALID_HANDLE
 POSITIVECASE    = FALSE
-
-PROVNAME        = INVALID-LONG
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYSPEC         = 2
-KEYFLAGS        = 0
+
+PROVNAME        = INVALID-LONG
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = CngKspApitestKey
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 
 ; ------------------------------- 5
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFreeObject.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFreeObject.inf
index cf6139b66c92ef..0ce80945b3f3bb 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFreeObject.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptFreeObject.inf
@@ -41,13 +41,13 @@ NUMBEROFCASES  = 2
 
 
 VARID           = 1.2
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptGetProperty.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptGetProperty.inf
index c3397916330932..971b9dd3e0cb7d 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptGetProperty.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptGetProperty.inf
@@ -39,302 +39,302 @@ NUMBEROFCASES  = 37
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 
 
 VARID           = 1.2
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Algorithm Name
 
 
 VARID           = 1.3
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Length
 
 
 VARID           = 1.4
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Lengths
 
 
 VARID           = 1.5
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Block Length
 
 
 VARID           = 1.6
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 
 VARID           = 1.7
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_NOT_FOUND
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_NOT_FOUND
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = HWND Handle
 
 ;VARID           = 1.8
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Impl Type
 
 
 ;VARID           = 1.9
-;TESTNAME        = set export policy after the key is finalized
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = set export policy after the key is finalized
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Version
 
 ;VARID           = 1.10
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 4
 ;PROPERTY        = Security Descr
 
 
 ;VARID           = 1.11
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_NOT_FOUND
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_NOT_FOUND
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Use Count
 
 
 ;VARID           = 1.12
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Modified
 
 
 ;VARID           = 1.13
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Max Name Length
 
 
 VARID           = 1.14
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 05000000
 
 
 VARID           = 1.15
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 07000000
 
 
 VARID           = 1.16
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 0f000000
 
 
 VARID           = 1.17
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Length
 PROPERTY_VALUE  = 80000000
 
 VARID           = 1.18
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Length
 PROPERTY_VALUE  = FF000000
 
 
 ;VARID           = 1.19
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
 
 ;VARID           = 1.20
-;TESTNAME        = hwind
-;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = hwind
+;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 00000040
@@ -344,247 +344,247 @@ PROPERTY_VALUE  = FF000000
 ; NULL handle value (alg does not matter)
 
 ;VARID           = 2.1
-;TESTNAME        = setting Key usage after key is finalized
-;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = setting Key usage after key is finalized
+;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Key Usage
 ;PROPERTY_VALUE  = 01000000
 
 ;VARID           = 2.2
-;TESTNAME        = set export policy after the key is finalized
-;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = set export policy after the key is finalized
+;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Export Policy
 ;PROPERTY_VALUE  = 0F000000
 
 
 ;VARID           = 2.3
-;TESTNAME        = 3 bytes of Export Policy
-;EXPECTEDVALUE   = NTE_BAD_DATA
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = 3 bytes of Export Policy
+;EXPECTEDVALUE   = NTE_BAD_DATA
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Export Policy
 ;PROPERTY_VALUE  = 0F0000
 
 ;VARID           = 2.4
-;TESTNAME        = 3 bytes of Key Usage
-;EXPECTEDVALUE   = NTE_BAD_DATA
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = 3 bytes of Key Usage
+;EXPECTEDVALUE   = NTE_BAD_DATA
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Key Usage
 ;PROPERTY_VALUE  = 0F0000
 
 ;VARID           = 2.5
-;TESTNAME        = setting key length after key is finalized
-;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 1024
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = setting key length after key is finalized
+;EXPECTEDVALUE   = NTE_BAD_KEY_STATE
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 1024
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Length
 ;PROPERTY_VALUE  = FF000000
 
 ;VARID           = 2.6
-;TESTNAME        = setting key length after key is finalized
-;EXPECTEDVALUE   = NTE_BAD_DATA
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = setting key length after key is finalized
+;EXPECTEDVALUE   = NTE_BAD_DATA
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Length
 ;PROPERTY_VALUE  = 80
 
 VARID           = 2.7
-TESTNAME        = invalid property
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = invalid property
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = INVALID-LONG
 PROPERTY_VALUE  = 80
 
 VARID           = 2.8
-TESTNAME        = invalid property
-EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+TESTNAME        = invalid property
+EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = INVALID-SHORT
 PROPERTY_VALUE  = 80
 
 
 ;VARID           = 2.9
-;TESTNAME        = security descriptor length too long
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 10000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = security descriptor length too long
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 10000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
 
 
 ;VARID           = 2.10
-;TESTNAME        = security descriptor length too short
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 20000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = security descriptor length too short
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 20000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
 
 
 ;VARID           = 2.11
-;TESTNAME        = null security descriptor
-;EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 40000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = null security descriptor
+;EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 40000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
 
 
 ;VARID           = 2.12
-;TESTNAME        = invalid security descriptor
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 80000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = invalid security descriptor
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 80000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
 
 ;VARID           = 2.14
-;TESTNAME        = 1 byte hwind
-;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = 1 byte hwind
+;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 80
 
 ;VARID           = 2.15
-;TESTNAME        = 2 bytes hwind
-;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = 2 bytes hwind
+;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 8080
 
 
 ;VARID           = 2.16
-;TESTNAME        = 3 bytes hwind
-;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = 3 bytes hwind
+;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 808080
 
 ;VARID           = 2.17
-;TESTNAME        = NULL hwind
-;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;TESTNAME        = NULL hwind
+;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 00000000
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptImportKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptImportKey.inf
index 706ce5ea33e952..ebecaf4a7778f5 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptImportKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptImportKey.inf
@@ -40,13 +40,13 @@ NUMBEROFCASES  = 11
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = test888
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -126,13 +126,13 @@ DELIMPORTED     = FALSE
 
 
 VARID           = 1.4
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = test888
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -156,13 +156,13 @@ DELIMPORTED     = FALSE
 
 
 VARID           = 1.5
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = test888
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -184,13 +184,13 @@ DELETE		= TRUE
 DELIMPORTED     = FALSE
 
 VARID           = 1.6
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = test888
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -213,13 +213,13 @@ DELIMPORTED     = FALSE
 
 
 VARID           = 1.7
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = test888
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -241,13 +241,13 @@ DELETE		= TRUE
 DELIMPORTED     = FALSE
 
 VARID           = 1.8
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test888
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -271,13 +271,13 @@ DELIMPORTED     = FALSE
 
 
 VARID           = 1.9
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = test888
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -301,13 +301,13 @@ DELETE		= TRUE
 
 
 VARID           = 1.10
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = test888
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -331,13 +331,13 @@ DELIMPORTED     = TRUE
 
 
 VARID           = 1.11
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test888
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test888
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsAlgSupported.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsAlgSupported.inf
index ef8b49f658fcb4..4e59da866a8294 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsAlgSupported.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsAlgSupported.inf
@@ -38,13 +38,13 @@ NUMBEROFCASES  = 19
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 2
-ALGID           = RSA
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 2
+ALGID           = RSA
+FLAGS           = 0
 
 
 
@@ -61,24 +61,24 @@ FLAGS           = 0
 
 
 VARID           = 1.3
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;fRSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;f
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;fRSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;f
+FLAGS           = 0
 
 
 
 VARID           = 1.4
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;f
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSAdasda;sdas;kdlsak;dksalkdl;sakdlaskfl;ja;lfjel;j;lwkl;dkwl;kdal;skfl;asdjf;lasjfl;asjf;jdasfjearou9wareujglizsdjg903t-0248ugopsJDGoldsjo;f
+FLAGS           = 0
 
 
 
@@ -87,141 +87,141 @@ FLAGS           = 0
 ;
 
 VARID           = 1.5
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+FLAGS           = 1
 
 VARID           = 1.6
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P384
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P384
+FLAGS           = 1
 
 
 VARID           = 1.7
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P521
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+FLAGS           = 1
 
 
 VARID           = 1.8
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+FLAGS           = 1
 
 VARID           = 1.9
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+FLAGS           = 1
 
 
 VARID           = 1.10
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-FLAGS           = 2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+FLAGS           = 2
 
 
 VARID           = 1.11
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-FLAGS           = 1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+FLAGS           = 1
 
 
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.12
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+FLAGS           = 0
 
 VARID           = 1.13
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P384
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P384
+FLAGS           = 0
 
 
 VARID           = 1.14
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P521
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P521
+FLAGS           = 0
 
 
 VARID           = 1.15
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+FLAGS           = 0
 
 VARID           = 1.16
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+FLAGS           = 0
 
 
 VARID           = 1.17
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+FLAGS           = 0
 
 
 VARID           = 1.18
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-FLAGS           = 0
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+FLAGS           = 0
 
 
 ;=====================NEGATIVE TESTS====================
@@ -229,13 +229,13 @@ FLAGS           = 0
 ; invalid algrithm (alg does not matter)
 
 VARID           = 2.19
-TESTNAME        = invalid alg
-EXPECTEDVALUE   = NTE_NOT_SUPPORTED
-POSITIVECASE    = FLASE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = SRA
-FLAGS           = 0
+TESTNAME        = invalid alg
+EXPECTEDVALUE   = NTE_NOT_SUPPORTED
+POSITIVECASE    = FLASE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = SRA
+FLAGS           = 0
 
 
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsKeyHandle.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsKeyHandle.inf
index 68ccd923053e78..247608df76c440 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsKeyHandle.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptIsKeyHandle.inf
@@ -39,13 +39,13 @@ NUMBEROFCASES  = 2
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = FALSE
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = FALSE
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 1024  ; call NCryptFinalizeKey
 KEYSPEC         = 2
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptNotifyChangeKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptNotifyChangeKey.inf
index 409ba24b726a1a..e498a9931a6977 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptNotifyChangeKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptNotifyChangeKey.inf
@@ -45,13 +45,13 @@ NUMBEROFCASES  = 3
 
 
 ;VARID           = 1.1
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = INVALID-LONG
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = INVALID-LONG
 ;KEYLEN          = 0
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -59,13 +59,13 @@ NUMBEROFCASES  = 3
 ;HANDLEVALID     = TRUE
 
 VARID           = 1.2
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -73,13 +73,13 @@ FLAGS           = 1
 HANDLEVALID     = TRUE
 
 ;VARID           = 1.3
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = ERROR_SUCCESS
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = INVALID-LONG
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = ERROR_SUCCESS
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = INVALID-LONG
 ;KEYLEN          = 0
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -88,13 +88,13 @@ HANDLEVALID     = TRUE
 
 
 ;VARID           = 1.4
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_INVALID_HANDLE
-;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_INVALID_HANDLE
+;POSITIVECASE    = FALSE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = CngKspApitestKey
 ;KEYLEN          = 0
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -104,13 +104,13 @@ HANDLEVALID     = TRUE
 
 
 ;VARID           = 1.5
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_INVALID_HANDLE
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = INVALID-LONG
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_INVALID_HANDLE
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = INVALID-LONG
 ;KEYLEN          = 256
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -118,13 +118,13 @@ HANDLEVALID     = TRUE
 ;HANDLEVALID     = FALSE
 
 ;VARID           = 1.6
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_INVALID_HANDLE
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = ECDSA_P256
-;KEYNAME         = test
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_INVALID_HANDLE
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = ECDSA_P256
+;KEYNAME         = test
 ;KEYLEN          = 256
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -132,13 +132,13 @@ HANDLEVALID     = TRUE
 ;HANDLEVALID     = TRUE
 
 ;VARID           = 1.7
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_INVALID_HANDLE
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = ECDH_P256
-;KEYNAME         = test
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_INVALID_HANDLE
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = ECDH_P256
+;KEYNAME         = test
 ;KEYLEN          = 256
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -146,13 +146,13 @@ HANDLEVALID     = TRUE
 ;HANDLEVALID     = TRUE
 
 ;VARID           = 1.8
-;TESTNAME        = Valid parameters for MS storage provider
-;EXPECTEDVALUE   = NTE_INVALID_HANDLE
-;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = test
+;TESTNAME        = Valid parameters for MS storage provider
+;EXPECTEDVALUE   = NTE_INVALID_HANDLE
+;POSITIVECASE    = TRUE
+;PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = test
 ;KEYLEN          = 0
 ;KEYSPEC         = 2
 ;KEYFLAGS        = 0
@@ -160,13 +160,13 @@ HANDLEVALID     = TRUE
 ;HANDLEVALID     = TRUE
 
 VARID           = 1.9
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -175,13 +175,13 @@ HANDLEVALID     = TRUE
 
 
 VARID           = 1.21
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenKey.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenKey.inf
index 09bfbfd746beca..fa28e2e101c2e9 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenKey.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenKey.inf
@@ -40,13 +40,13 @@ NUMBEROFCASES  = 8
 ; invalid provider handle
 
 VARID           = 2.1
-TESTNAME        = bad handle
-EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 2
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = bad handle
+EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 2
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -74,13 +74,13 @@ KEYHANDLEVALID  = VALID
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -88,13 +88,13 @@ FLAGS           = 0
 KEYHANDLEVALID  = VALID
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -102,13 +102,13 @@ FLAGS           = 0
 KEYHANDLEVALID  = VALID
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -118,13 +118,13 @@ KEYHANDLEVALID  = VALID
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -135,13 +135,13 @@ KEYHANDLEVALID  = VALID
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -150,13 +150,13 @@ KEYHANDLEVALID  = INVALID
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenStorageProvider.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenStorageProvider.inf
index d689709edf8902..482bf7656336cc 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenStorageProvider.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptOpenStorageProvider.inf
@@ -40,50 +40,50 @@ NUMBEROFCASES  = 4
 ;=====================POSITIVE TESTS====================
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVHANDLE      = VALID
-FLAGS           = 0
-
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVHANDLE      = VALID
+FLAGS           = 0
+
 
 ;=====================NEGATIVE TESTS====================
 
 ; with invalid handle, the ouptput handle is NULL
 
 VARID           = 2.1
-TESTNAME        = NULL handle
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVHANDLE      = NULL
-FLAGS           = 0
-
+TESTNAME        = NULL handle
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVHANDLE      = NULL
+FLAGS           = 0
+
 ;invalid handle value (alg does not matter)
 ; same as above
 
 VARID           = 3.1
-TESTNAME        = INVALID handle
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVHANDLE      = INVALID
-FLAGS           = 0
-
+TESTNAME        = INVALID handle
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVHANDLE      = INVALID
+FLAGS           = 0
+
 
 
 
 
 ; invalid flags
 VARID           = 4.5
-TESTNAME        = INVALID flags
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVHANDLE      = VALID
-FLAGS           = 123
-
+TESTNAME        = INVALID flags
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVHANDLE      = VALID
+FLAGS           = 123
+
 ;================ with issues ================
 
 ; invalid provder name
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSecretAgreementAPI.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSecretAgreementAPI.inf
index 48749e70fce67e..d2c29d647f3651 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSecretAgreementAPI.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSecretAgreementAPI.inf
@@ -47,13 +47,13 @@ ALGID           = DH
 SECRETHANDLE    = VALID
 KEYLEN		= 1024
 PUBKEYHANDLE    = VALID
-PRIVKEYHANDLE   = VALID
-FLAGS           = 0
-KEYSPEC         = 1
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-VARID           = 1.2
+PRIVKEYHANDLE   = VALID
+FLAGS           = 0
+KEYSPEC         = 1
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+VARID           = 1.2
 TESTNAME        = ECDH_P256 with valid params
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
@@ -61,13 +61,13 @@ ALGID           = ECDH_P256
 SECRETHANDLE    = VALID
 KEYLEN		= 256
 PUBKEYHANDLE    = VALID
-PRIVKEYHANDLE   = VALID
-FLAGS           = 0
-KEYSPEC         = 0
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-
+PRIVKEYHANDLE   = VALID
+FLAGS           = 0
+KEYSPEC         = 0
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+
 VARID           = 1.3
 TESTNAME        = ECDH_P384 with valid params
 EXPECTEDVALUE   = ERROR_SUCCESS
@@ -76,13 +76,13 @@ ALGID           = ECDH_P384
 SECRETHANDLE    = VALID
 KEYLEN		= 384
 PUBKEYHANDLE    = VALID
-PRIVKEYHANDLE   = VALID
-FLAGS           = 0
-KEYSPEC         = 0
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-VARID           = 1.4
+PRIVKEYHANDLE   = VALID
+FLAGS           = 0
+KEYSPEC         = 0
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+VARID           = 1.4
 TESTNAME        = ECDH_P521 with valid params
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
@@ -90,13 +90,13 @@ ALGID           = ECDH_P521
 SECRETHANDLE    = VALID
 KEYLEN		= 521
 PUBKEYHANDLE    = VALID
-PRIVKEYHANDLE   = VALID
-FLAGS           = 0
-KEYSPEC         = 0
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
-
-;=====================NEGATIVE TESTS====================
+PRIVKEYHANDLE   = VALID
+FLAGS           = 0
+KEYSPEC         = 0
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
+
+;=====================NEGATIVE TESTS====================
 
 ; bad handle tests (alg does not matter)
 ;bug won't fix
@@ -108,8 +108,8 @@ ALGID           = DH
 SECRETHANDLE    = INVALID
 KEYLEN		= 1024
 PUBKEYHANDLE    = VALID
-PRIVKEYHANDLE   = VALID
-FLAGS           = 0
-KEYSPEC         = 0
-PROVNAME        = Microsoft Software Key Storage Provider
-KEYFLAGS	= 0
+PRIVKEYHANDLE   = VALID
+FLAGS           = 0
+KEYSPEC         = 0
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+KEYFLAGS	= 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSetProperty.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSetProperty.inf
index 76f7a10d6ddec7..b6d6ae86f3c8bc 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSetProperty.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSetProperty.inf
@@ -42,13 +42,13 @@ VARID           = 1.1
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = ffffff00
@@ -58,13 +58,13 @@ VARID           = 1.2
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 01000000
@@ -74,13 +74,13 @@ VARID           = 1.3
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 02000000
@@ -90,13 +90,13 @@ VARID           = 1.4
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 04000000
@@ -106,13 +106,13 @@ VARID           = 1.5
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 03000000
@@ -122,13 +122,13 @@ VARID           = 1.6
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 05000000
@@ -137,13 +137,13 @@ VARID           = 1.7
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 06000000
@@ -152,13 +152,13 @@ VARID           = 1.8
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 07000000
@@ -168,13 +168,13 @@ VARID           = 1.9
 TESTNAME        = set export policy after the key is finalized
 EXPECTEDVALUE   = NTE_BAD_KEY_STATE
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 0F000000
@@ -183,13 +183,13 @@ VARID           = 1.10
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 01000000
@@ -199,13 +199,13 @@ VARID           = 1.11
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 02000000
@@ -215,13 +215,13 @@ VARID           = 1.12
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 04000000
@@ -231,13 +231,13 @@ VARID           = 1.13
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 03000000
@@ -247,13 +247,13 @@ VARID           = 1.14
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 05000000
@@ -263,13 +263,13 @@ VARID           = 1.15
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 07000000
@@ -279,13 +279,13 @@ VARID           = 1.16
 TESTNAME        = Valid parameters for MS storage provider
 EXPECTEDVALUE   = ERROR_SUCCESS
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 0f000000
@@ -295,13 +295,13 @@ PROPERTY_VALUE  = 0f000000
 ;TESTNAME        = Valid parameters for MS storage provider
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Length
 ;PROPERTY_VALUE  = 80000000
@@ -310,13 +310,13 @@ PROPERTY_VALUE  = 0f000000
 ;TESTNAME        = Valid parameters for MS storage provider
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Length
 ;PROPERTY_VALUE  = FF000000
@@ -326,13 +326,13 @@ PROPERTY_VALUE  = 0f000000
 ;TESTNAME        = Valid parameters for MS storage provider
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
@@ -341,13 +341,13 @@ PROPERTY_VALUE  = 0f000000
 ;TESTNAME        = hwind
 ;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 00000040
@@ -360,13 +360,13 @@ VARID           = 2.1
 TESTNAME        = setting Key usage after key is finalized
 EXPECTEDVALUE   = NTE_BAD_KEY_STATE
 POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 01000000
@@ -375,13 +375,13 @@ VARID           = 2.2
 TESTNAME        = set export policy after the key is finalized
 EXPECTEDVALUE   = NTE_BAD_KEY_STATE
 POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 0F000000
@@ -391,13 +391,13 @@ VARID           = 2.3
 TESTNAME        = 3 bytes of Export Policy
 EXPECTEDVALUE   = NTE_BAD_DATA
 POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Export Policy
 PROPERTY_VALUE  = 0F0000
@@ -406,13 +406,13 @@ VARID           = 2.4
 TESTNAME        = 3 bytes of Key Usage
 EXPECTEDVALUE   = NTE_BAD_DATA
 POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Key Usage
 PROPERTY_VALUE  = 0F0000
@@ -421,13 +421,13 @@ VARID           = 2.5
 TESTNAME        = setting key length after key is finalized
 EXPECTEDVALUE   = NTE_BAD_KEY_STATE
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 1024
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 1024
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Length
 PROPERTY_VALUE  = FF000000
@@ -436,13 +436,13 @@ VARID           = 2.6
 TESTNAME        = setting key length after key is finalized
 EXPECTEDVALUE   = NTE_BAD_DATA
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = Length
 PROPERTY_VALUE  = 80
@@ -451,13 +451,13 @@ VARID           = 2.7
 TESTNAME        = invalid property
 EXPECTEDVALUE   = NTE_INVALID_PARAMETER
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = INVALID-LONG
 PROPERTY_VALUE  = 80
@@ -466,13 +466,13 @@ VARID           = 2.8
 TESTNAME        = invalid property
 EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
-KEYLEN          = 0
-KEYSPEC         = 2
-KEYFLAGS        = 0
+PROVNAME        = Microsoft Software Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+KEYLEN          = 0
+KEYSPEC         = 2
+KEYFLAGS        = 0
 FLAGS           = 0
 PROPERTY        = INVALID-SHORT
 PROPERTY_VALUE  = 80
@@ -482,13 +482,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = security descriptor length too long
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 10000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 10000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
@@ -498,13 +498,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = security descriptor length too short
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 20000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 20000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
@@ -514,13 +514,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = null security descriptor
 ;EXPECTEDVALUE   = NTE_INVALID_PARAMETER
 ;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 40000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 40000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
@@ -530,13 +530,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = invalid security descriptor
 ;EXPECTEDVALUE   = ERROR_SUCCESS
 ;POSITIVECASE    = FALSE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 80000000
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 80000000
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = Security Descr
 ;PROPERTY_VALUE  = "O:SYG:SYD:(A;;RPWPCRCCDCLCLOLORCWOWDSDDTDTSW;;;SY)(A;;RPLCLORC;;;AU)"
@@ -545,13 +545,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = 1 byte hwind
 ;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 80
@@ -560,13 +560,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = 2 bytes hwind
 ;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 8080
@@ -576,13 +576,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = 3 bytes hwind
 ;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 808080
@@ -591,13 +591,13 @@ PROPERTY_VALUE  = 80
 ;TESTNAME        = NULL hwind
 ;EXPECTEDVALUE   = NTE_NOT_SUPPORTED
 ;POSITIVECASE    = TRUE
-;PROVNAME        = Microsoft Software Key Storage Provider
-;PROVFLAGS       = 0
-;ALGID           = RSA
-;KEYNAME         = CngKspApitestKey
-;KEYLEN          = 0
-;KEYSPEC         = 2
-;KEYFLAGS        = 0
+;PROVNAME        = Microsoft Software Key Storage Provider
+;PROVFLAGS       = 0
+;ALGID           = RSA
+;KEYNAME         = AZIHSM_BUILTIN_UNWRAP_KEY
+;KEYLEN          = 0
+;KEYSPEC         = 2
+;KEYFLAGS        = 0
 ;FLAGS           = 0
 ;PROPERTY        = HWND Handle
 ;PROPERTY_VALUE  = 00000000
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSignHash.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSignHash.inf
index 454d59acf686b2..e192f0bf6945ca 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSignHash.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptSignHash.inf
@@ -40,13 +40,13 @@ NUMBEROFCASES  = 14
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -56,13 +56,13 @@ HASHID          = SHA1
 
 
 VARID           = 1.2
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -73,13 +73,13 @@ HASHID          = SHA1
 
 
 VARID           = 1.3
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test3
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = STATUS_ACCESS_VIOLATION
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test3
 KEYLEN          = 0
 KEYSPEC         = 2
 KEYFLAGS        = 2
@@ -106,13 +106,13 @@ HASHID          = SHA512
 
 
 VARID           = 1.5
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-SHORT
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_HANDLE
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-SHORT
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -122,13 +122,13 @@ HASHID          = SHA512
 
 
 VARID           = 1.6
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -144,13 +144,13 @@ HASHID          = SHA512
 ;
 
 VARID           = 1.7
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -160,13 +160,13 @@ HASHID          = SHA384
 
 
 VARID           = 1.8
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -180,13 +180,13 @@ HASHID          = SHA256
 ;
 
 VARID           = 1.9
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test2
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test2
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -197,13 +197,13 @@ HASHID          = SHA1
 
 
 VARID           = 1.10
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 2
 KEYFLAGS        = 0
@@ -217,13 +217,13 @@ HASHID          = MD2
 ; signing for ECDSA should ignore the hash algorithm
 ;
 VARID           = 1.11
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = test1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = test1
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -235,13 +235,13 @@ HASHID          = MD6
 ; MD5 padding is 18 bytes
 ;
 VARID           = 1.12
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = test1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = test1
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -256,13 +256,13 @@ HASHID          = NULL
 ; MD5 padding is 18 bytes
 ;
 VARID           = 1.13
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDSA_P256
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDSA_P256
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -272,13 +272,13 @@ HASHID          = MD5
 
 
 VARID           = 1.14
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -287,13 +287,13 @@ INPUTLEN        = 16
 HASHID          = MD5
 
 VARID           = 1.17
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -310,13 +310,13 @@ HASHID          = NULL
 ; no signing for ECDH
 ;
 VARID           = 1.18
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P256
-KEYNAME         = test1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P256
+KEYNAME         = test1
 KEYLEN          = 256
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -330,13 +330,13 @@ HASHID          = MD2
 ; no signing for ECDH
 ;
 VARID           = 1.19
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P384
-KEYNAME         = test1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P384
+KEYNAME         = test1
 KEYLEN          = 384
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -350,13 +350,13 @@ HASHID          = MD2
 ; no signing for ECDH
 ;
 VARID           = 1.20
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_ALGID
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = ECDH_P521
-KEYNAME         = test1
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_ALGID
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = ECDH_P521
+KEYNAME         = test1
 KEYLEN          = 521
 KEYSPEC         = 0
 KEYFLAGS        = 0
@@ -368,13 +368,13 @@ HASHID          = MD2
 
 
 VARID           = 1.15
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_BAD_FLAGS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_BAD_FLAGS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 1
 KEYFLAGS        = 0
@@ -384,13 +384,13 @@ HASHID          = NULL
 
 
 VARID           = 1.14
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = TRUE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = CngKspApitestKey
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = TRUE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = CngKspApitestKey
 KEYLEN          = 1024
 KEYSPEC         = 0
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptVerifySignature.inf b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptVerifySignature.inf
index e4f2a9e4ad0899..9c4efe0c80fa50 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptVerifySignature.inf
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/cfg/NCryptVerifySignature.inf
@@ -40,13 +40,13 @@ NUMBEROFCASES  = 4
 
 
 VARID           = 1.1
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test4
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test4
 KEYLEN          = 1024
 KEYSPEC         = 1
 KEYFLAGS        = 0
@@ -59,13 +59,13 @@ SIGNFLAGS        = 2
 
 
 VARID           = 1.2
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = ERROR_SUCCESS
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test5
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = ERROR_SUCCESS
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test5
 KEYLEN          = 1088
 KEYSPEC         = 1
 KEYFLAGS        = 0
@@ -77,13 +77,13 @@ SIGID         	= MD2
 SIGNFLAGS        = 2
 
 VARID           = 1.3
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_HANDLE
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = INVALID-LONG
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_HANDLE
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = INVALID-LONG
 KEYLEN          = 1088
 KEYSPEC         = 1
 KEYFLAGS        = 0
@@ -96,13 +96,13 @@ SIGNFLAGS        = 0
 
 
 VARID           = 1.5
-TESTNAME        = Valid parameters for MS storage provider
-EXPECTEDVALUE   = NTE_INVALID_PARAMETER
-POSITIVECASE    = FALSE
-PROVNAME        = Microsoft Software Key Storage Provider
-PROVFLAGS       = 0
-ALGID           = RSA
-KEYNAME         = test4
+TESTNAME        = Valid parameters for MS storage provider
+EXPECTEDVALUE   = NTE_INVALID_PARAMETER
+POSITIVECASE    = FALSE
+PROVNAME        = Microsoft Azure Integrated HSM Key Storage Provider
+PROVFLAGS       = 0
+ALGID           = RSA
+KEYNAME         = test4
 KEYLEN          = 1088
 KEYSPEC         = 1
 KEYFLAGS        = 0
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/globaliz.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/globaliz.cpp
index d03ff05eff00c6..6b7a424536558b 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/globaliz.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/globaliz.cpp
@@ -841,13 +841,13 @@ Return Value:
     BCRYPT_DH_PARAMETER_HEADER  *pbDhParamHdr      = NULL;
     
     //get a handle to MS KSP
-
-    if (!NT_SUCCESS(secStatus = NCryptOpenStorageProvider(
-        &hProvA,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(secStatus = NCryptOpenStorageProvider(
+        &hProvA,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
@@ -1396,13 +1396,13 @@ Return Value:
 
     NCRYPT_KEY_HANDLE       tempHandle = NULL;
 
-    //get a handle to MS KSP
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+    //get a handle to MS KSP
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/handles.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/handles.cpp
index b4b88b39eb55ec..71abeab017d69a 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/handles.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/handles.cpp
@@ -516,13 +516,13 @@ Return Value:
 
     }
 
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
@@ -715,13 +715,13 @@ Return Value:
 
 
     //delete the key to cleanup
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/property.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/property.cpp
index 152998e8c7a176..c85d08d434304b 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/property.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/legacyKSPtests/property.cpp
@@ -191,13 +191,13 @@ Return Value:
     PBYTE                   pbData          = NULL;
     DWORD                   cbData          = 0;
     DWORD                   dwData          = 0;
-
-    const LPCWSTR pszKspAliases[] = 
-    {
-        MS_KEY_STORAGE_PROVIDER,
-        MS_DEF_PROV,
-        MS_ENHANCED_PROV,
-        MS_STRONG_PROV,
+
+    const LPCWSTR pszKspAliases[] =
+    {
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        MS_DEF_PROV,
+        MS_ENHANCED_PROV,
+        MS_STRONG_PROV,
         MS_DEF_RSA_SIG_PROV,
         MS_DEF_RSA_SCHANNEL_PROV,
         MS_DEF_DSS_PROV,
@@ -292,13 +292,13 @@ Return Value:
         dwData = 0;
 
 
-        //test implementation flag
-
-        DWORD expectedImplType = NCRYPT_IMPL_SOFTWARE_FLAG;
-        if (wcscmp(pszKspAliases[dwKspAliasId], MS_KEY_STORAGE_PROVIDER) == 0)
-        {
-            expectedImplType |= NCRYPT_IMPL_VIRTUAL_ISOLATION_FLAG;
-        }
+        //test implementation flag
+
+        DWORD expectedImplType = NCRYPT_IMPL_SOFTWARE_FLAG;
+        if (wcscmp(pszKspAliases[dwKspAliasId], AZIHSM_KEY_STORAGE_PROVIDER) == 0)
+        {
+            expectedImplType |= NCRYPT_IMPL_VIRTUAL_ISOLATION_FLAG;
+        }
 
         cbData = sizeof(DWORD);
 
@@ -384,13 +384,13 @@ Return Value:
     DWORD                   cbData          = 0;
 
     LOG_OUTPUT(L"Start Test - AlgorithmPropertyTests\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
     
@@ -602,13 +602,13 @@ Return Value:
 
 
     LOG_OUTPUT(L"Start Test - NamePropertyTests\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
@@ -1005,13 +1005,13 @@ Return Value:
     DWORD                   cbData          = sizeof(DWORD);
 
     LOG_OUTPUT(L"Start Test - KeyUsePropertyTests - defaults\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
     
@@ -1467,13 +1467,13 @@ Return Value:
 
 
     LOG_OUTPUT(L"Start Test - KeyLengthPropertyTest\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
     
@@ -1782,13 +1782,13 @@ Return Value:
     const DWORD             dwMyProperty3   = 1003;
 
     LOG_OUTPUT(L"Start Test - PersistAndReadArbitraryProperties\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
     
@@ -2298,13 +2298,13 @@ Return Value:
 
 
     LOG_OUTPUT(L"Start Test - ExportAndArchiveTests\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
     //
@@ -2792,13 +2792,13 @@ Return Value:
 
 
     LOG_OUTPUT(L"Start Test - LastModifiedProperty\n");
-
-    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0)))
-    {
-        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
+
+    if (!NT_SUCCESS(status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0)))
+    {
+        LOG_OUTPUT(L"NCryptOpenStorageProvider failed with 0x%x\n", GetLastError());
         goto Cleanup;
     }
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs11.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs11.cpp
index 9ee9f1ca80aaa4..ecc521b5356605 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs11.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs11.cpp
@@ -1670,13 +1670,13 @@ Pkcs11TestImportKeys()
     NCRYPT_PROV_HANDLE hProvider = NULL;
 
     //DbgBreakPoint();
-
-    Status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (FAILED(Status))
-    {
+
+    Status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (FAILED(Status))
+    {
         LOG_OUTPUT(L"****Pkcs11TestImportKeys: ERROR: Pkcs11TestImportKeys returned 0x%08x\n", Status);
         goto cleanup;
     }
@@ -1705,17 +1705,17 @@ static
 SECURITY_STATUS
 Pkcs11TestImportKeysPerf()
 {
-    NTSTATUS            Status    = S_OK;
-    NCRYPT_PROV_HANDLE  hProvider = NULL;
-
-    Status = NCryptOpenStorageProvider(&hProvider, MS_KEY_STORAGE_PROVIDER, 0);
-    if (!NT_SUCCESS(Status))
-    {
-        LOG_OUTPUT(L"****Pkcs11TestImportKeysPerf: ERROR: NCryptOpenStorageProvider(%lS) returned error 0x%08x\n",
-                   MS_KEY_STORAGE_PROVIDER, Status);
-        goto cleanup;
-    }
-
+    NTSTATUS            Status    = S_OK;
+    NCRYPT_PROV_HANDLE  hProvider = NULL;
+
+    Status = NCryptOpenStorageProvider(&hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0);
+    if (!NT_SUCCESS(Status))
+    {
+        LOG_OUTPUT(L"****Pkcs11TestImportKeysPerf: ERROR: NCryptOpenStorageProvider(%lS) returned error 0x%08x\n",
+                   AZIHSM_KEY_STORAGE_PROVIDER, Status);
+        goto cleanup;
+    }
+
     LOG_OUTPUT(L"\nSTART - Pkcs11TestImportKeysPerf: Running performance tests\n");
 
     for (PKCS11_IMPORT_TEST_PARAMS testParams : PERFORMANCE_IMPORT_TESTS)
@@ -2160,13 +2160,13 @@ Pkcs11TestExportKeys()
     NCRYPT_PROV_HANDLE hProvider = NULL;
 
     //DbgBreakPoint();
-
-    Status = NCryptOpenStorageProvider(
-        &hProvider,
-        MS_KEY_STORAGE_PROVIDER,
-        0);
-    if (FAILED(Status))
-    {
+
+    Status = NCryptOpenStorageProvider(
+        &hProvider,
+        AZIHSM_KEY_STORAGE_PROVIDER,
+        0);
+    if (FAILED(Status))
+    {
         LOG_OUTPUT(L"****Pkcs11TestExportKeys: ERROR: NCryptOpenStorageProvider returned 0x%08x\n", Status);
         goto cleanup;
     }
@@ -2380,17 +2380,17 @@ static
 SECURITY_STATUS
 Pkcs11TestExportKeysPerf()
 {
-    NTSTATUS            Status    = S_OK;
-    NCRYPT_PROV_HANDLE  hProvider = NULL;
-
-    Status = NCryptOpenStorageProvider(&hProvider, MS_KEY_STORAGE_PROVIDER, 0);
-    if (!NT_SUCCESS(Status))
-    {
-        LOG_OUTPUT(L"****Pkcs11TestExportKeysPerf: ERROR: NCryptOpenStorageProvider(%lS) returned error 0x%08x\n",
-                   MS_KEY_STORAGE_PROVIDER, Status);
-        goto cleanup;
-    }
-
+    NTSTATUS            Status    = S_OK;
+    NCRYPT_PROV_HANDLE  hProvider = NULL;
+
+    Status = NCryptOpenStorageProvider(&hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0);
+    if (!NT_SUCCESS(Status))
+    {
+        LOG_OUTPUT(L"****Pkcs11TestExportKeysPerf: ERROR: NCryptOpenStorageProvider(%lS) returned error 0x%08x\n",
+                   AZIHSM_KEY_STORAGE_PROVIDER, Status);
+        goto cleanup;
+    }
+
     LOG_OUTPUT(L"\nSTART - Pkcs11TestExportKeysPerf: Running performance tests\n");
 
     for (PKCS11_EXPORT_TEST_PARAMS testParams : PERFORMANCE_EXPORT_TESTS)
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs8.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs8.cpp
index e38b0ad73f7829..26d5e543b95b0c 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs8.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/pkcs8.cpp
@@ -676,13 +676,13 @@ cleanup:
 static SECURITY_STATUS Pkcs8Encode()
 {
     SECURITY_STATUS Status;
-    NCRYPT_PROV_HANDLE hProvider = NULL;
-
-    // Open the storage provider.
-    Status = NCryptOpenStorageProvider(&hProvider, MS_KEY_STORAGE_PROVIDER, 0);
-    if (FAILED(Status))
-    {
-        LOG_OUTPUT(L"****Pkcs8Encode: ERROR: NCryptOpenStorageProvider returned 0x%08x\n", Status);
+    NCRYPT_PROV_HANDLE hProvider = NULL;
+
+    // Open the storage provider.
+    Status = NCryptOpenStorageProvider(&hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0);
+    if (FAILED(Status))
+    {
+        LOG_OUTPUT(L"****Pkcs8Encode: ERROR: NCryptOpenStorageProvider returned 0x%08x\n", Status);
         goto cleanup;
     }
 
diff --git a/onecore/ds/security/cryptoapi/ncrypt/test/storage/reliability.cpp b/onecore/ds/security/cryptoapi/ncrypt/test/storage/reliability.cpp
index c91eff70c5626e..5e721bdc622a09 100644
--- a/onecore/ds/security/cryptoapi/ncrypt/test/storage/reliability.cpp
+++ b/onecore/ds/security/cryptoapi/ncrypt/test/storage/reliability.cpp
@@ -242,13 +242,13 @@ OpenKeyHandles()
     NCRYPT_PROV_HANDLE hProvider = NULL;
     NCRYPT_KEY_HANDLE hKey = NULL;
     SECURITY_STATUS Status = ERROR_SUCCESS;
-    std::vector<std::thread> threads;
-    DWORD dwCount = 0;
-
-    Status = NCryptOpenStorageProvider(&hProvider, MS_KEY_STORAGE_PROVIDER, 0);
-    if (Status != ERROR_SUCCESS)
-    {
-        LOG_OUTPUT(L"****OpenKeyHandles: NCryptOpenStorageProvider failed with 0x%08x\n", Status);
+    std::vector<std::thread> threads;
+    DWORD dwCount = 0;
+
+    Status = NCryptOpenStorageProvider(&hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0);
+    if (Status != ERROR_SUCCESS)
+    {
+        LOG_OUTPUT(L"****OpenKeyHandles: NCryptOpenStorageProvider failed with 0x%08x\n", Status);
         goto cleanup;
     }
 
@@ -451,13 +451,13 @@ RefreshKeyHandle(
         goto cleanup;
     }
     pKeyHandleInfo->hKey = NULL;
-
-    Status = NCryptOpenStorageProvider(
-                &hProvider,
-                MS_KEY_STORAGE_PROVIDER,
-                0);
-    if (Status != ERROR_SUCCESS)
-    {
+
+    Status = NCryptOpenStorageProvider(
+                &hProvider,
+                AZIHSM_KEY_STORAGE_PROVIDER,
+                0);
+    if (Status != ERROR_SUCCESS)
+    {
         LOG_OUTPUT(L"****RefreshKeyHandle: NCryptOpenStorageProvider failed with 0x%08x\n", Status);
         goto cleanup;
     }
@@ -596,13 +596,13 @@ NcaWorker(
     DWORD cbClaim = 0;
     PBYTE pbClaim = NULL;
     NCryptBufferDesc OutputBuffer = {0};
-
-    dwKeyIndex = GenRandomHandleIndex(testInfo.dwKeysPerThread, dwThreadIdx);
-
-    Status = NCryptOpenStorageProvider(&hProvider, MS_KEY_STORAGE_PROVIDER, 0);
-    if (Status != ERROR_SUCCESS)
-    {
-        LOG_OUTPUT(L"****NcaWorker: NCryptOpenStorageProvider failed with 0x%08x\n", Status);
+
+    dwKeyIndex = GenRandomHandleIndex(testInfo.dwKeysPerThread, dwThreadIdx);
+
+    Status = NCryptOpenStorageProvider(&hProvider, AZIHSM_KEY_STORAGE_PROVIDER, 0);
+    if (Status != ERROR_SUCCESS)
+    {
+        LOG_OUTPUT(L"****NcaWorker: NCryptOpenStorageProvider failed with 0x%08x\n", Status);
         goto cleanup;
     }
 
